{"version":3,"file":"embed-plugin-noembed.min.js","sources":["../../../node_modules/just-extend/index.js","../../../node_modules/just-flatten-it/index.js","../../embed-plugin-utilities/src/string-replace-async.js","../../embed-plugin-utilities/src/insert.js","../src/index.js","../src/noembed-regex.js","../../../node_modules/is-in-browser/dist/module.js","../../../node_modules/is-dom/index.js","../../../node_modules/just-pluck-it/index.js","../../embed-plugin-base/src/index.js"],"sourcesContent":["module.exports = extend;\n\n/*\n  var obj = {a: 3, b: 5};\n  extend(obj, {a: 4, c: 8}); // {a: 4, b: 5, c: 8}\n  obj; // {a: 4, b: 5, c: 8}\n\n  var obj = {a: 3, b: 5};\n  extend({}, obj, {a: 4, c: 8}); // {a: 4, b: 5, c: 8}\n  obj; // {a: 3, b: 5}\n\n  var arr = [1, 2, 3];\n  var obj = {a: 3, b: 5};\n  extend(obj, {c: arr}); // {a: 3, b: 5, c: [1, 2, 3]}\n  arr.push(4);\n  obj; // {a: 3, b: 5, c: [1, 2, 3, 4]}\n\n  var arr = [1, 2, 3];\n  var obj = {a: 3, b: 5};\n  extend(true, obj, {c: arr}); // {a: 3, b: 5, c: [1, 2, 3]}\n  arr.push(4);\n  obj; // {a: 3, b: 5, c: [1, 2, 3]}\n\n  extend({a: 4, b: 5}); // {a: 4, b: 5}\n  extend({a: 4, b: 5}, 3); {a: 4, b: 5}\n  extend({a: 4, b: 5}, true); {a: 4, b: 5}\n  extend('hello', {a: 4, b: 5}); // throws\n  extend(3, {a: 4, b: 5}); // throws\n*/\n\nfunction extend(/* [deep], obj1, obj2, [objn] */) {\n  var args = [].slice.call(arguments);\n  var deep = false;\n  if (typeof args[0] == 'boolean') {\n    deep = args.shift();\n  }\n  var result = args[0];\n  if (!result || (typeof result != 'object' && typeof result != 'function')) {\n    throw new Error('extendee must be an object');\n  }\n  var extenders = args.slice(1);\n  var len = extenders.length;\n  for (var i = 0; i < len; i++) {\n    var extender = extenders[i];\n    for (var key in extender) {\n      if (extender.hasOwnProperty(key)) {\n        var value = extender[key];\n        if (deep && isCloneable(value)) {\n          var base = Array.isArray(value) ? [] : {};\n          result[key] = extend(true, result.hasOwnProperty(key) ? result[key] : base, value);\n        } else {\n          result[key] = value;\n        }\n      }\n    }\n  }\n  return result;\n}\n\nfunction isCloneable(obj) {\n  return Array.isArray(obj) || {}.toString.call(obj) == '[object Object]';\n}\n","module.exports = flatten;\n\n/*\n  flatten([[1, [2, 3]], [[4, 5], 6, 7, [8, 9]]]);\n  // [1, 2, 3, 4, 5, 6, 7, 8, 9]\n*/\n\nfunction flatten(arr) {\n  if (!Array.isArray(arr)) {\n    throw new Error('expected an array');\n  }\n  var result = [];\n  var len = arr.length;\n  for (var i = 0; i < len; i++) {\n    var elem = arr[i];\n    if (Array.isArray(elem)) {\n      result.push.apply(result, flatten(elem));\n    } else {\n      result.push(elem);\n    }\n  }\n  return result;\n}\n","import extend from \"just-extend\"\n\nfunction matchAll(str, re) {\n  const matches = []\n  let res = re.exec(str)\n\n  while (res) {\n    matches.push(res)\n\n    if (!re.global) {\n      break\n    }\n\n    res = re.exec(str)\n  }\n  return matches\n}\n\nfunction replaceAll(str, matches) {\n  return matches.reverse().reduce(function(res, match) {\n    const prefix = res.slice(0, match.index)\n    const postfix = res.slice(match.index + match[0].length)\n\n    return prefix + match.replacement + postfix\n  }, str)\n}\n\nfunction assignReplacement(match, replacer) {\n  const args = match.concat([match.index, match.input])\n\n  return replacer.apply(null, args).then(function(res) {\n    return extend({}, match, { replacement: res })\n  })\n}\n\nfunction concurrency(matches, replacer) {\n  const promises = matches.map(function(match) {\n    return assignReplacement(match, replacer)\n  })\n\n  return Promise.all(promises)\n}\n\nfunction processString(str, re, replacer) {\n  const matches = matchAll(str, re)\n  const processor = concurrency\n\n  return processor(matches, replacer).then(function(matches) {\n    return replaceAll(str, matches)\n  })\n}\n\nfunction stringReplaceAsync(str, re, replacer) {\n  re.lastIndex = 0\n  try {\n    return Promise.resolve(processString(str, re, replacer))\n  } catch (e) {\n    return Promise.reject(e)\n  }\n}\n\nexport default stringReplaceAsync\n","import extend from \"just-extend\"\nimport stringReplaceAsync from \"./string-replace-async\"\n\nconst anchorRegex = /<a[^>]*>([^<]+)<\\/a>/gi\n\nfunction getAnchorRegex(regex) {\n  return new RegExp(`<a[^>]*>(${regex.source})<\\\\/a>`, \"gi\")\n}\n\n/**\n * Returns the matched regex data or whether the text has any matching string\n * @param regex Regex of the matching pattern\n * @param text String which has to be searched\n * @param test Return boolean or matching array\n * @returns {*} Boolean|Array\n */\nfunction isMatchPresent(regex, text, test = false) {\n  return test ? regex.test(text) : text.match(regex)\n}\n\n/**\n * Tells wheteher the matching string is present inside an anchor tag\n * @param text\n * @returns {*} Boolean\n * @param regex\n */\nfunction isAnchorTagApplied({ result, plugins = [] }, { regex }) {\n  return (\n    getAnchorRegex(regex).test(result) ||\n    plugins.filter(plugin => plugin.id === \"url\").length\n  )\n}\n\nfunction saveServiceName({ _services }, { id }, match) {\n  if (!_services.filter(x => x.match === match).length) {\n    _services.push({ id, match })\n  }\n}\n\nasync function pushEmbedContent(text, options, pluginOptions, index) {\n  const { regex } = pluginOptions\n  await stringReplaceAsync(text, regex, async (...args) => {\n    options._embeds.push({\n      content: await getTemplate(args, options, pluginOptions),\n      index: index || args.find(x => typeof x === \"number\")\n    })\n    saveServiceName(options, pluginOptions, args[0])\n  })\n  return options\n}\n\n/**\n * Save the embed code into an array that can be added later to the end of original string\n * @param opts\n * @param pluginOptions\n */\nasync function saveEmbedData(opts, pluginOptions) {\n  const { regex } = pluginOptions\n  let options = extend({}, opts)\n\n  if (isAnchorTagApplied(options, { regex })) {\n    await stringReplaceAsync(\n      options.result,\n      anchorRegex,\n      async (match, url, index) => {\n        if (!isMatchPresent(regex, match, true)) return match\n        saveServiceName(options, pluginOptions, match)\n        options = await pushEmbedContent(url, options, pluginOptions, index)\n        return match\n      }\n    )\n  } else {\n    options = pushEmbedContent(options.result, options, pluginOptions)\n  }\n\n  return options\n}\n\nfunction getMatch(regex, string) {\n  regex.lastIndex = 0\n  const matches = regex.exec(string)\n  regex.lastIndex = 0\n  return matches\n}\n\nasync function getTemplate(args, options, pluginOptions) {\n  const { _process, template } = pluginOptions\n  let data\n  if (_process) {\n    data = await _process(args, options, pluginOptions)\n  }\n  return template(args, options, pluginOptions, data)\n}\n\nasync function basicReplace(options, pluginOptions) {\n  const { result, replaceUrl } = options\n  const { regex, _replaceAnyways } = pluginOptions\n  return stringReplaceAsync(result, regex, async (...args) => {\n    saveServiceName(options, pluginOptions, args[0])\n    return replaceUrl || _replaceAnyways\n      ? getTemplate(args, options, pluginOptions)\n      : `${args[0]} ${await getTemplate(args, options, pluginOptions)}`\n  })\n}\n\nasync function anchorReplace(options, pluginOptions) {\n  const { result, replaceUrl } = options\n  const { regex, _replaceAnyways } = pluginOptions\n\n  return stringReplaceAsync(result, anchorRegex, async (match, url) => {\n    if (!isMatchPresent(regex, url, true)) {\n      return match\n    }\n\n    if (!(replaceUrl || _replaceAnyways)) {\n      const args = getMatch(regex, url)\n      saveServiceName(options, pluginOptions, args[0])\n      const t = await getTemplate(args, options, pluginOptions)\n      return args ? match + t : match\n    }\n    return stringReplaceAsync(url, regex, async (...args) => {\n      saveServiceName(options, pluginOptions, args[0])\n      return getTemplate(args, options, pluginOptions)\n    })\n  })\n}\n\n/**\n * Insert the embed code in the original string.\n * @param options\n * @param pluginOptions\n * @returns options\n */\nexport default async function(options, pluginOptions) {\n  const { inlineEmbed } = options\n  const { _ignoreAnchorCheck, _ignoreInlineCheck, regex } = pluginOptions\n\n  if (!inlineEmbed && !_ignoreInlineCheck) {\n    return saveEmbedData(options, pluginOptions)\n  }\n\n  let output\n\n  output =\n    isAnchorTagApplied(options, { regex }) && !_ignoreAnchorCheck\n      ? await anchorReplace(options, pluginOptions)\n      : await basicReplace(options, pluginOptions)\n\n  return extend({}, options, {\n    result: output\n  })\n}\n","import extend from \"just-extend\"\nimport isBrowser from \"is-in-browser\"\nimport isDom from \"is-dom\"\nimport getRegex, { isServicePresent } from \"./noembed-regex\"\nimport base from \"embed-plugin-base\"\n\nconst id = \"noEmbed\"\n\n/**\n * Fetches the data from the noembed API\n * @param args\n * @returns {Promise.<*>}\n */\nasync function _process(args, { fetch }) {\n  const url = args[0]\n  try {\n    const res = await fetch(`https://noembed.com/embed?url=${url}`)\n    return await res.json()\n  } catch (e) {\n    return {\n      html: url\n    }\n  }\n}\n\nfunction noEmbed(opts = {}) {\n  const defaultOptions = {\n    id,\n    // Regex to be used to identify noembed supported services.\n    // By default it takes from noembed-regex.js\n    regex: null,\n\n    // In case you want to exclude a few services, you can do it here.\n    // It accepts an array of service names in lowercase.\n    exclude: [],\n\n    twttr: isBrowser ? window.twttr : null,\n\n    onLoad() {},\n\n    async template(args, options, pluginOptions, { html }) {\n      return `<div class=\"ejs-embed\">${html}</div>`\n    },\n\n    _onLoadInternal({ input, result }, { twttr, onLoad }) {\n      if (isServicePresent(\"twitter\", result) && twttr && isDom(input)) {\n        twttr.widgets.load(input)\n        twttr.events.bind(\"loaded\", onLoad)\n      }\n    }\n  }\n\n  const pluginOptions = extend({}, defaultOptions, opts, {\n    _process\n  })\n\n  if (!opts.regex) {\n    pluginOptions.regex = getRegex(pluginOptions.exclude)\n  }\n\n  return base(pluginOptions)\n}\n\nnoEmbed.id = id\n\nexport default noEmbed\n","import pluck from \"just-pluck-it\"\nimport flatten from \"just-flatten-it\"\n\nconst regexes = [\n  {\n    patterns: [\"https?://soundcloud.com/.*/.[^\\\\s]*\"],\n    name: \"SoundCloud\"\n  },\n  {\n    name: \"slideshare\",\n    patterns: [\n      \"https?://www\\\\.slideshare\\\\.net/.*/.[^\\\\s]*\",\n      \"https?://fr\\\\.slideshare\\\\.net/.*/.[^\\\\s]*\",\n      \"https?://de\\\\.slideshare\\\\.net/.*/.[^\\\\s]*\",\n      \"https?://es\\\\.slideshare\\\\.net/.*/.[^\\\\s]*\",\n      \"https?://pt\\\\.slideshare\\\\.net/.*/.[^\\\\s]*\"\n    ]\n  },\n  {\n    name: \"vimeo\",\n    patterns: [\n      \"https?://vimeo\\\\.com/.[^\\\\s]*\",\n      \"https?://vimeo\\\\.com/album/.*/video/.[^\\\\s]*\",\n      \"https?://vimeo\\\\.com/channels/.*/.[^\\\\s]*\",\n      \"https?://vimeo\\\\.com/groups/.*/videos/.[^\\\\s]*\",\n      \"https?://vimeo\\\\.com/ondemand/.*/.[^\\\\s]*\"\n    ]\n  },\n  {\n    patterns: [\n      \"https?://photos\\\\.app\\\\.net/.*/.[^\\\\s]*\",\n      \"https?://live\\\\.amcharts\\\\.com/.[^\\\\s]*\",\n      \"https?://codepen\\\\.io/.[^\\\\s]*\",\n      \"https?://codepen\\\\.io/.[^\\\\s]*\",\n      \"https?://www\\\\.collegehumor\\\\.com/video/.[^\\\\s]*\",\n      \"https?://www\\\\.dailymotion\\\\.com/video/.[^\\\\s]*\",\n      \"https?://.*\\\\.deviantart\\\\.com/art/.[^\\\\s]*\",\n      \"https?://.*\\\\.deviantart\\\\.com/.*#/d.[^\\\\s]*\",\n      \"https?://dotsub\\\\.com/view/.[^\\\\s]*\",\n      \"https?://.*\\\\.flickr\\\\.com/photos/.[^\\\\s]*\",\n      \"https?://flic\\\\.kr/p/.[^\\\\s]*\",\n      \"https?://.*\\\\.wikimedia\\\\.org/.*_geograph\\\\.org\\\\.uk_.[^\\\\s]*\",\n      \"https?://gfycat\\\\.com/.[^\\\\s]*\",\n      \"https?://www\\\\.gfycat\\\\.com/.[^\\\\s]*\",\n      \"https?://gfycat\\\\.com/.[^\\\\s]*\",\n      \"https?://www\\\\.gfycat\\\\.com/.[^\\\\s]*\",\n      \"https?://giphy\\\\.com/gifs/.[^\\\\s]*\",\n      \"https?://media\\\\.giphy\\\\.com/media/.*/giphy\\\\.gif\",\n      \"https?://www\\\\.hulu\\\\.com/watch/.[^\\\\s]*\",\n      \"https?://www\\\\.kickstarter\\\\.com/projects/.[^\\\\s]*\",\n      \"https?://www\\\\.mixcloud\\\\.com/.*/.*/\",\n      \"https?://reddit\\\\.com/r/.*/comments/.*/.[^\\\\s]*\",\n      \"https?://.*\\\\.screen9\\\\.tv/.[^\\\\s]*\",\n      \"https?://www\\\\.scribd\\\\.com/doc/.[^\\\\s]*\",\n      \"https?://.*\\\\.smugmug\\\\.com/.[^\\\\s]*\",\n      \"https?://soundcloud\\\\.com/.[^\\\\s]*\",\n      \"https?://play\\\\.soundsgood\\\\.co/playlist/.[^\\\\s]*\",\n      \"https?://speakerdeck\\\\.com/.*/.[^\\\\s]*\",\n      \"https?://speakerdeck\\\\.com/.*/.[^\\\\s]*\",\n      \"https?://ted\\\\.com/talks/.[^\\\\s]*\",\n      \"https?://www\\\\.nytimes\\\\.com/svc/oembed\",\n      \"https?://nytimes\\\\.com/.[^\\\\s]*\",\n      \"https?://.*\\\\.nytimes\\\\.com/.[^\\\\s]*\",\n      \"https?://clips\\\\.twitch\\\\.tv/.[^\\\\s]*\",\n      \"https?://clips\\\\.twitch\\\\.tv/.[^\\\\s]*\",\n      \"https?://www\\\\.twitch\\\\.tv/.[^\\\\s]*\",\n      \"https?://www\\\\.twitch\\\\.tv/.[^\\\\s]*\",\n      \"https?://twitch\\\\.tv/.[^\\\\s]*\",\n      \"https?://twitch\\\\.tv/.[^\\\\s]*\",\n      \"https?://.*\\\\.ustream\\\\.tv/.[^\\\\s]*\",\n      \"https?://.*\\\\.ustream\\\\.com/.[^\\\\s]*\",\n      \"https?://veervr\\\\.tv/videos/.[^\\\\s]*\",\n      \"https?://www\\\\.vevo\\\\.com/.[^\\\\s]*\",\n      \"https?://www\\\\.vevo\\\\.com/.[^\\\\s]*\",\n      \"https?://player\\\\.vimeo\\\\.com/video/.[^\\\\s]*\",\n      \"https?://vine\\\\.co/v/.[^\\\\s]*\",\n      \"https?://vine\\\\.co/v/.[^\\\\s]*\"\n    ],\n    name: \"oEmbed\"\n  },\n  {\n    name: \"Imgur\",\n    patterns: [\"https?://imgur\\\\.com/(?:[^\\\\/]+/)?[0-9a-zA-Z]+$\"]\n  },\n  {\n    patterns: [\n      \"https?://www\\\\.(dropbox\\\\.com/s/.+\\\\.(?:jpg|png|gif))\",\n      \"https?://db\\\\.tt/[a-zA-Z0-9][^\\\\s]+\"\n    ],\n    name: \"Dropbox\"\n  },\n  // #if IS_CJS\n  {\n    patterns: [\n      \"https?:\\\\/\\\\/(?:[^\\\\.]+\\\\.)?youtube\\\\.com\\\\/watch\\\\/?\\\\?(?:.+&)?v=([^&][^\\\\s]+)\",\n      \"https?://(?:[^\\\\.]+\\\\.)?(?:youtu\\\\.be|youtube\\\\.com/embed)/([a-zA-Z0-9_-][^\\\\s]+)\"\n    ],\n    name: \"YouTube\"\n  },\n  // #endif\n  {\n    patterns: [\n      \"https?://(?:www|mobile\\\\.)?twitter\\\\.com/(?:#!/)?([^/]+)/status(?:es)?/(\\\\d+)\"\n    ],\n    name: \"Twitter\"\n  }\n]\n\nexport default function getRegexes(excludeServices = []) {\n  const includedRegexes = regexes.filter(\n    r => excludeServices.indexOf(r.name.toLowerCase()) === -1\n  )\n  const patterns = flatten(pluck(includedRegexes, \"patterns\"))\n  return new RegExp(patterns.join(\"|\"), \"gi\")\n}\n\nexport function isServicePresent(serviceName, text) {\n  const service = regexes.filter(r => r.name.toLowerCase() === serviceName)[0]\n  const regex = new RegExp(service.patterns.join(\"|\"), \"gi\")\n  return regex.test(text)\n}\n","var _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexport var isBrowser = (typeof window === \"undefined\" ? \"undefined\" : _typeof(window)) === \"object\" && (typeof document === \"undefined\" ? \"undefined\" : _typeof(document)) === 'object' && document.nodeType === 9;\n\nexport default isBrowser;\n","module.exports = isNode\n\nfunction isNode (val) {\n  return (!val || typeof val !== 'object')\n    ? false\n    : (typeof window === 'object' && typeof window.Node === 'object')\n      ? (val instanceof window.Node)\n      : (typeof val.nodeType === 'number') &&\n        (typeof val.nodeName === 'string')\n}\n","module.exports = pluck;\n\n/*\n  var arr = [{a:1, b:2}, {a:4, b:3}, {a:2, b:5}];\n  pluck(arr, 'a'); // [1, 4, 2]\n  var obj = {x: {a:1, b:2}, y: {a:4, b:3}, z: {a:2, b:5}];\n  pluck(obj, 'a'); // {x: 1, y: 4, z: 2}\n*/\n\nfunction pluck(collection, propertyName) {\n  if (!collection || typeof collection != 'object') {\n    return new Error('expected first argument to be an object or array');\n  }\n\n  var result, len, i, keys, key;\n  if (Array.isArray(collection)) {\n    result = [];\n    len = collection.length;\n    for (i = 0; i < len; i++) {\n      result.push(collection[i][propertyName]);\n    }\n  } else {\n    result = {};\n    keys = Object.keys(collection);\n    len = keys.length;\n    for (i = 0; i < len; i++) {\n      key = keys[i];\n      result[key] = collection[key][propertyName];\n    }\n  }\n  return result;\n}\n","import extend from \"just-extend\"\nimport { insert } from \"embed-plugin-utilities\"\n\nexport default opts => {\n  const defaultOptions = {\n    _replaceAnyways: false,\n    _ignoreAnchorCheck: false,\n    _ignoreInlineCheck: false,\n    onLoad() {}\n  }\n\n  const pluginOptions = extend({}, defaultOptions, opts)\n\n  const { _onLoadInternal, onLoad, regex, template, id } = pluginOptions\n\n  if (!regex) {\n    throw new Error(\"regex not passed.\")\n  }\n  if (!template) {\n    throw new Error(\"template not passed.\")\n  }\n\n  return {\n    id,\n\n    async transform(options) {\n      return extend({}, options, await insert(options, pluginOptions))\n    },\n\n    onLoad(options) {\n      if (_onLoadInternal) {\n        _onLoadInternal(options, pluginOptions)\n      }\n      if (onLoad) {\n        onLoad(options, pluginOptions)\n      }\n    }\n  }\n}\n"],"names":["extend","args","slice","call","arguments","deep","shift","result","Error","extenders","len","length","i","extender","key","hasOwnProperty","value","obj","Array","isArray","toString","isCloneable","base","flatten","arr","elem","push","apply","concurrency","matches","replacer","const","promises","map","match","concat","index","input","then","res","replacement","assignReplacement","Promise","all","stringReplaceAsync","str","re","lastIndex","resolve","exec","global","matchAll","reverse","reduce","prefix","postfix","replaceAll","processString","e","reject","isMatchPresent","regex","text","test","isAnchorTagApplied","ref","ref$1","RegExp","getAnchorRegex","plugins","filter","plugin","id","saveServiceName","_services","x","pushEmbedContent","options","pluginOptions","getTemplate","_embeds","content","$await_7","find","template","data","_process","$await_11","fetch","url","html","$await_2","json","noEmbed","opts","defaultOptions","exclude","twttr","isBrowser","window","onLoad","_onLoadInternal","serviceName","service","regexes","r","name","toLowerCase","patterns","join","isServicePresent","isDom","widgets","load","events","bind","excludeServices","includedRegexes","indexOf","pluck","getRegex","_typeof","Symbol","iterator","constructor","prototype","document","nodeType","val","Node","nodeName","collection","propertyName","keys","Object","anchorRegex","inlineEmbed","_ignoreAnchorCheck","_ignoreInlineCheck","replaceUrl","_replaceAnyways","string","getMatch","t","$await_14","anchorReplace","$await_12","basicReplace","output","$await_17","$await_9","saveEmbedData","transform","insert","$await_1"],"mappings":"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"}