'use strict';

function _interopDefault (ex) { return (ex && (typeof ex === 'object') && 'default' in ex) ? ex['default'] : ex; }

var extend = _interopDefault(require('just-extend'));
var emojiRegex = _interopDefault(require('regex-emoji'));
var kebab = _interopDefault(require('just-kebab-case'));

const id = "emoji";
function emoji(opts) {
    const defaultOptions = {
        id,
        regex: emojiRegex(),
        template(emojiName) {
            return `<span class="ec ec-${kebab(emojiName)}"></span>`;
        }
    };
    const pluginOptions = extend({}, defaultOptions, opts);
    return {
        transform(options) {
            return Promise.resolve(extend({}, options, {
                result: options.result.replace(pluginOptions.regex, (match, emojiName) => {
                    options._services.push({
                        id,
                        match
                    });
                    return pluginOptions.template(emojiName, options, pluginOptions);
                })
            }));
        }
    };
}

emoji.id = id;

module.exports = emoji;
