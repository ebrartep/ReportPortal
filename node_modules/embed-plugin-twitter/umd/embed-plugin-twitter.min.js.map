{"version":3,"file":"embed-plugin-twitter.min.js","sources":["../../../node_modules/just-extend/index.js","../../embed-plugin-utilities/src/string-replace-async.js","../../embed-plugin-utilities/src/insert.js","../src/index.js","../../../node_modules/is-dom/index.js","../../../node_modules/is-in-browser/dist/module.js","../../embed-plugin-utilities/src/get-query.js","../../embed-plugin-base/src/index.js","../../../node_modules/fetch-jsonp/build/fetch-jsonp.js"],"sourcesContent":["module.exports = extend;\n\n/*\n  var obj = {a: 3, b: 5};\n  extend(obj, {a: 4, c: 8}); // {a: 4, b: 5, c: 8}\n  obj; // {a: 4, b: 5, c: 8}\n\n  var obj = {a: 3, b: 5};\n  extend({}, obj, {a: 4, c: 8}); // {a: 4, b: 5, c: 8}\n  obj; // {a: 3, b: 5}\n\n  var arr = [1, 2, 3];\n  var obj = {a: 3, b: 5};\n  extend(obj, {c: arr}); // {a: 3, b: 5, c: [1, 2, 3]}\n  arr.push(4);\n  obj; // {a: 3, b: 5, c: [1, 2, 3, 4]}\n\n  var arr = [1, 2, 3];\n  var obj = {a: 3, b: 5};\n  extend(true, obj, {c: arr}); // {a: 3, b: 5, c: [1, 2, 3]}\n  arr.push(4);\n  obj; // {a: 3, b: 5, c: [1, 2, 3]}\n\n  extend({a: 4, b: 5}); // {a: 4, b: 5}\n  extend({a: 4, b: 5}, 3); {a: 4, b: 5}\n  extend({a: 4, b: 5}, true); {a: 4, b: 5}\n  extend('hello', {a: 4, b: 5}); // throws\n  extend(3, {a: 4, b: 5}); // throws\n*/\n\nfunction extend(/* [deep], obj1, obj2, [objn] */) {\n  var args = [].slice.call(arguments);\n  var deep = false;\n  if (typeof args[0] == 'boolean') {\n    deep = args.shift();\n  }\n  var result = args[0];\n  if (!result || (typeof result != 'object' && typeof result != 'function')) {\n    throw new Error('extendee must be an object');\n  }\n  var extenders = args.slice(1);\n  var len = extenders.length;\n  for (var i = 0; i < len; i++) {\n    var extender = extenders[i];\n    for (var key in extender) {\n      if (extender.hasOwnProperty(key)) {\n        var value = extender[key];\n        if (deep && isCloneable(value)) {\n          var base = Array.isArray(value) ? [] : {};\n          result[key] = extend(true, result.hasOwnProperty(key) ? result[key] : base, value);\n        } else {\n          result[key] = value;\n        }\n      }\n    }\n  }\n  return result;\n}\n\nfunction isCloneable(obj) {\n  return Array.isArray(obj) || {}.toString.call(obj) == '[object Object]';\n}\n","import extend from \"just-extend\"\n\nfunction matchAll(str, re) {\n  const matches = []\n  let res = re.exec(str)\n\n  while (res) {\n    matches.push(res)\n\n    if (!re.global) {\n      break\n    }\n\n    res = re.exec(str)\n  }\n  return matches\n}\n\nfunction replaceAll(str, matches) {\n  return matches.reverse().reduce(function(res, match) {\n    const prefix = res.slice(0, match.index)\n    const postfix = res.slice(match.index + match[0].length)\n\n    return prefix + match.replacement + postfix\n  }, str)\n}\n\nfunction assignReplacement(match, replacer) {\n  const args = match.concat([match.index, match.input])\n\n  return replacer.apply(null, args).then(function(res) {\n    return extend({}, match, { replacement: res })\n  })\n}\n\nfunction concurrency(matches, replacer) {\n  const promises = matches.map(function(match) {\n    return assignReplacement(match, replacer)\n  })\n\n  return Promise.all(promises)\n}\n\nfunction processString(str, re, replacer) {\n  const matches = matchAll(str, re)\n  const processor = concurrency\n\n  return processor(matches, replacer).then(function(matches) {\n    return replaceAll(str, matches)\n  })\n}\n\nfunction stringReplaceAsync(str, re, replacer) {\n  re.lastIndex = 0\n  try {\n    return Promise.resolve(processString(str, re, replacer))\n  } catch (e) {\n    return Promise.reject(e)\n  }\n}\n\nexport default stringReplaceAsync\n","import extend from \"just-extend\"\nimport stringReplaceAsync from \"./string-replace-async\"\n\nconst anchorRegex = /<a[^>]*>([^<]+)<\\/a>/gi\n\nfunction getAnchorRegex(regex) {\n  return new RegExp(`<a[^>]*>(${regex.source})<\\\\/a>`, \"gi\")\n}\n\n/**\n * Returns the matched regex data or whether the text has any matching string\n * @param regex Regex of the matching pattern\n * @param text String which has to be searched\n * @param test Return boolean or matching array\n * @returns {*} Boolean|Array\n */\nfunction isMatchPresent(regex, text, test = false) {\n  return test ? regex.test(text) : text.match(regex)\n}\n\n/**\n * Tells wheteher the matching string is present inside an anchor tag\n * @param text\n * @returns {*} Boolean\n * @param regex\n */\nfunction isAnchorTagApplied({ result, plugins = [] }, { regex }) {\n  return (\n    getAnchorRegex(regex).test(result) ||\n    plugins.filter(plugin => plugin.id === \"url\").length\n  )\n}\n\nfunction saveServiceName({ _services }, { id }, match) {\n  if (!_services.filter(x => x.match === match).length) {\n    _services.push({ id, match })\n  }\n}\n\nasync function pushEmbedContent(text, options, pluginOptions, index) {\n  const { regex } = pluginOptions\n  await stringReplaceAsync(text, regex, async (...args) => {\n    options._embeds.push({\n      content: await getTemplate(args, options, pluginOptions),\n      index: index || args.find(x => typeof x === \"number\")\n    })\n    saveServiceName(options, pluginOptions, args[0])\n  })\n  return options\n}\n\n/**\n * Save the embed code into an array that can be added later to the end of original string\n * @param opts\n * @param pluginOptions\n */\nasync function saveEmbedData(opts, pluginOptions) {\n  const { regex } = pluginOptions\n  let options = extend({}, opts)\n\n  if (isAnchorTagApplied(options, { regex })) {\n    await stringReplaceAsync(\n      options.result,\n      anchorRegex,\n      async (match, url, index) => {\n        if (!isMatchPresent(regex, match, true)) return match\n        saveServiceName(options, pluginOptions, match)\n        options = await pushEmbedContent(url, options, pluginOptions, index)\n        return match\n      }\n    )\n  } else {\n    options = pushEmbedContent(options.result, options, pluginOptions)\n  }\n\n  return options\n}\n\nfunction getMatch(regex, string) {\n  regex.lastIndex = 0\n  const matches = regex.exec(string)\n  regex.lastIndex = 0\n  return matches\n}\n\nasync function getTemplate(args, options, pluginOptions) {\n  const { _process, template } = pluginOptions\n  let data\n  if (_process) {\n    data = await _process(args, options, pluginOptions)\n  }\n  return template(args, options, pluginOptions, data)\n}\n\nasync function basicReplace(options, pluginOptions) {\n  const { result, replaceUrl } = options\n  const { regex, _replaceAnyways } = pluginOptions\n  return stringReplaceAsync(result, regex, async (...args) => {\n    saveServiceName(options, pluginOptions, args[0])\n    return replaceUrl || _replaceAnyways\n      ? getTemplate(args, options, pluginOptions)\n      : `${args[0]} ${await getTemplate(args, options, pluginOptions)}`\n  })\n}\n\nasync function anchorReplace(options, pluginOptions) {\n  const { result, replaceUrl } = options\n  const { regex, _replaceAnyways } = pluginOptions\n\n  return stringReplaceAsync(result, anchorRegex, async (match, url) => {\n    if (!isMatchPresent(regex, url, true)) {\n      return match\n    }\n\n    if (!(replaceUrl || _replaceAnyways)) {\n      const args = getMatch(regex, url)\n      saveServiceName(options, pluginOptions, args[0])\n      const t = await getTemplate(args, options, pluginOptions)\n      return args ? match + t : match\n    }\n    return stringReplaceAsync(url, regex, async (...args) => {\n      saveServiceName(options, pluginOptions, args[0])\n      return getTemplate(args, options, pluginOptions)\n    })\n  })\n}\n\n/**\n * Insert the embed code in the original string.\n * @param options\n * @param pluginOptions\n * @returns options\n */\nexport default async function(options, pluginOptions) {\n  const { inlineEmbed } = options\n  const { _ignoreAnchorCheck, _ignoreInlineCheck, regex } = pluginOptions\n\n  if (!inlineEmbed && !_ignoreInlineCheck) {\n    return saveEmbedData(options, pluginOptions)\n  }\n\n  let output\n\n  output =\n    isAnchorTagApplied(options, { regex }) && !_ignoreAnchorCheck\n      ? await anchorReplace(options, pluginOptions)\n      : await basicReplace(options, pluginOptions)\n\n  return extend({}, options, {\n    result: output\n  })\n}\n","import extend from \"just-extend\"\nimport isDom from \"is-dom\"\nimport isBrowser from \"is-in-browser\"\nimport base from \"embed-plugin-base\"\nimport { getQuery } from \"embed-plugin-utilities\"\nimport jsonp from \"fetch-jsonp\"\n\nconst id = \"twitter\"\n\n/**\n * Fetch the html content from the API\n * @param url\n * @param args\n * @param omitScript\n * @param maxWidth\n * @param hideMedia\n * @param hideThread\n * @param align\n * @param lang\n * @param theme\n * @param linkColor\n * @param widgetType\n * @returns {Promise.<*>}\n */\nasync function _process(\n  args,\n  { fetch },\n  {\n    _omitScript,\n    maxWidth,\n    hideMedia,\n    hideThread,\n    align,\n    lang,\n    theme,\n    linkColor,\n    widgetType\n  }\n) {\n  const params = {\n    url: args[0],\n    omitScript: _omitScript,\n    maxWidth,\n    hideMedia,\n    hideThread,\n    align,\n    lang,\n    theme,\n    linkColor,\n    widgetType\n  }\n  try {\n    const apiUrl = `https://api.twitter.com/1/statuses/oembed.json?${getQuery(\n      params\n    )}`\n    const res = await (isBrowser ? jsonp : fetch)(apiUrl)\n    return await res.json()\n  } catch (e) {\n    return {\n      html: \"\"\n    }\n  }\n}\n\nfunction renderTweet({ input, _services }, { twttr, onLoad }) {\n  if (!isDom(input)) {\n    throw new Error(\"input should be a DOM element to embed tweet.\")\n  }\n  if (_services.filter(service => service.id === \"twitter\").length) {\n    twttr.widgets.load(input)\n    twttr.events.bind(\"loaded\", onLoad)\n  }\n}\n\nexport default function twitter(opts) {\n  const defaultOptions = {\n    id,\n    // Regex that matches the string and sends to the template method.\n    regex: /https:\\/\\/twitter\\.com\\/\\w+\\/\\w+\\/\\d+/gi,\n\n    // The maximum width of a rendered Tweet in whole pixels.\n    // This value must be between 220 and 550 inclusive. A supplied\n    // value under or over the allowed range will be returned as the\n    // minimum or maximum supported width respectively; the reset width\n    // value will be reflected in the returned width property. Note that\n    // Twitter does not support the oEmbed maxheight parameter. Tweets\n    // are fundamentally text, and are therefore of unpredictable height\n    // that cannot be scaled like an image or video. Relatedly, the\n    // oEmbed response will not provide a value for height. Implementations\n    // that need consistent heights for Tweets should refer to the hide_thread\n    // and hide_media parameters below.\n    maxWidth: 550,\n\n    // When set to true , t, or 1 links in a Tweet are not expanded to photo,\n    // video, or link previews\n    hideMedia: false,\n\n    // When set to true , t, or 1 a collapsed version of the previous Tweet\n    // in a conversation thread will not be displayed when the requested Tweet\n    // is in reply to another Tweet\n    hideThread: false,\n\n    // Specifies whether the embedded Tweet should be floated left,\n    // right, or center in the page relative to the parent element.\n    // Valid values are left, right, center, and none\n    align: \"none\",\n\n    // Request returned HTML and a rendered Tweet in the specified Twitter\n    // language supported by embedded Tweets. https://dev.twitter.com/web/overview/languages\n    lang: \"en\",\n\n    // When set to dark, the Tweet is displayed with light text over a dark background\n    theme: \"light\",\n\n    // Adjust the color of Tweet text links with a hexadecimal color value\n    linkColor: \"#355acee\",\n\n    // Set to video to return a Twitter Video embed for the given Tweet\n    widgetType: \"\",\n\n    /**\n\t\t * It accepts the matching url and returns the html\n\t\t * content that replaces or appends to the URL based\n\t\t * on options. This can return a asynchronous response.\n\t\t * @param args\n\t\t * @param options\n\t\t * @param pluginOptions\n\t\t * @param html\n\t\t * @returns {Promise.<*>}\n\t\t */\n    template(args, options, pluginOptions, { html }) {\n      return html\n    },\n\n    // If you want to load the twitter widget script with the tweet itself\n    // turn this option to false. Else you have to load it externally.\n    _omitScript: true,\n\n    // The twitter object loaded from widgets.js. By default it takes twttr\n    // from window object.\n    twttr: isBrowser ? window.twttr : null,\n\n    // This is for internal use only. Executes when\n    // the tweet has been loaded\n    // and rendered on the client side\n    _onLoadInternal(options, pluginOptions) {\n      renderTweet(options, pluginOptions)\n    },\n\n    // executed when the tweet has been loaded\n    // and rendered on the client side\n    onLoad() {}\n  }\n\n  const pluginOptions = extend({}, defaultOptions, opts, {\n    _process\n  })\n  return base(pluginOptions)\n}\n\ntwitter.id = id\n","module.exports = isNode\n\nfunction isNode (val) {\n  return (!val || typeof val !== 'object')\n    ? false\n    : (typeof window === 'object' && typeof window.Node === 'object')\n      ? (val instanceof window.Node)\n      : (typeof val.nodeType === 'number') &&\n        (typeof val.nodeName === 'string')\n}\n","var _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexport var isBrowser = (typeof window === \"undefined\" ? \"undefined\" : _typeof(window)) === \"object\" && (typeof document === \"undefined\" ? \"undefined\" : _typeof(document)) === 'object' && document.nodeType === 9;\n\nexport default isBrowser;\n","export default function(params) {\n  const esc = encodeURIComponent\n  return Object.keys(params).map(k => `${esc(k)}=${esc(params[k])}`).join(\"&\")\n}\n","import extend from \"just-extend\"\nimport { insert } from \"embed-plugin-utilities\"\n\nexport default opts => {\n  const defaultOptions = {\n    _replaceAnyways: false,\n    _ignoreAnchorCheck: false,\n    _ignoreInlineCheck: false,\n    onLoad() {}\n  }\n\n  const pluginOptions = extend({}, defaultOptions, opts)\n\n  const { _onLoadInternal, onLoad, regex, template, id } = pluginOptions\n\n  if (!regex) {\n    throw new Error(\"regex not passed.\")\n  }\n  if (!template) {\n    throw new Error(\"template not passed.\")\n  }\n\n  return {\n    id,\n\n    async transform(options) {\n      return extend({}, options, await insert(options, pluginOptions))\n    },\n\n    onLoad(options) {\n      if (_onLoadInternal) {\n        _onLoadInternal(options, pluginOptions)\n      }\n      if (onLoad) {\n        onLoad(options, pluginOptions)\n      }\n    }\n  }\n}\n","(function (global, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define(['exports', 'module'], factory);\n  } else if (typeof exports !== 'undefined' && typeof module !== 'undefined') {\n    factory(exports, module);\n  } else {\n    var mod = {\n      exports: {}\n    };\n    factory(mod.exports, mod);\n    global.fetchJsonp = mod.exports;\n  }\n})(this, function (exports, module) {\n  'use strict';\n\n  var defaultOptions = {\n    timeout: 5000,\n    jsonpCallback: 'callback',\n    jsonpCallbackFunction: null\n  };\n\n  function generateCallbackFunction() {\n    return 'jsonp_' + Date.now() + '_' + Math.ceil(Math.random() * 100000);\n  }\n\n  function clearFunction(functionName) {\n    // IE8 throws an exception when you try to delete a property on window\n    // http://stackoverflow.com/a/1824228/751089\n    try {\n      delete window[functionName];\n    } catch (e) {\n      window[functionName] = undefined;\n    }\n  }\n\n  function removeScript(scriptId) {\n    var script = document.getElementById(scriptId);\n    if (script) {\n      document.getElementsByTagName('head')[0].removeChild(script);\n    }\n  }\n\n  function fetchJsonp(_url) {\n    var options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n    // to avoid param reassign\n    var url = _url;\n    var timeout = options.timeout || defaultOptions.timeout;\n    var jsonpCallback = options.jsonpCallback || defaultOptions.jsonpCallback;\n\n    var timeoutId = undefined;\n\n    return new Promise(function (resolve, reject) {\n      var callbackFunction = options.jsonpCallbackFunction || generateCallbackFunction();\n      var scriptId = jsonpCallback + '_' + callbackFunction;\n\n      window[callbackFunction] = function (response) {\n        resolve({\n          ok: true,\n          // keep consistent with fetch API\n          json: function json() {\n            return Promise.resolve(response);\n          }\n        });\n\n        if (timeoutId) clearTimeout(timeoutId);\n\n        removeScript(scriptId);\n\n        clearFunction(callbackFunction);\n      };\n\n      // Check if the user set their own params, and if not add a ? to start a list of params\n      url += url.indexOf('?') === -1 ? '?' : '&';\n\n      var jsonpScript = document.createElement('script');\n      jsonpScript.setAttribute('src', '' + url + jsonpCallback + '=' + callbackFunction);\n      if (options.charset) {\n        jsonpScript.setAttribute('charset', options.charset);\n      }\n      jsonpScript.id = scriptId;\n      document.getElementsByTagName('head')[0].appendChild(jsonpScript);\n\n      timeoutId = setTimeout(function () {\n        reject(new Error('JSONP request to ' + _url + ' timed out'));\n\n        clearFunction(callbackFunction);\n        removeScript(scriptId);\n        window[callbackFunction] = function () {\n          clearFunction(callbackFunction);\n        };\n      }, timeout);\n\n      // Caught if got 404/500\n      jsonpScript.onerror = function () {\n        reject(new Error('JSONP request to ' + _url + ' failed'));\n\n        clearFunction(callbackFunction);\n        removeScript(scriptId);\n        if (timeoutId) clearTimeout(timeoutId);\n      };\n    });\n  }\n\n  // export as global function\n  /*\n  let local;\n  if (typeof global !== 'undefined') {\n    local = global;\n  } else if (typeof self !== 'undefined') {\n    local = self;\n  } else {\n    try {\n      local = Function('return this')();\n    } catch (e) {\n      throw new Error('polyfill failed because global object is unavailable in this environment');\n    }\n  }\n  local.fetchJsonp = fetchJsonp;\n  */\n\n  module.exports = fetchJsonp;\n});"],"names":["extend","args","slice","call","arguments","deep","shift","result","Error","extenders","len","length","i","extender","key","hasOwnProperty","value","obj","Array","isArray","toString","isCloneable","base","concurrency","matches","replacer","const","promises","map","match","concat","index","input","apply","then","res","replacement","assignReplacement","Promise","all","stringReplaceAsync","str","re","lastIndex","resolve","exec","push","global","matchAll","reverse","reduce","prefix","postfix","replaceAll","processString","e","reject","isMatchPresent","regex","text","test","isAnchorTagApplied","ref","ref$1","RegExp","getAnchorRegex","plugins","filter","plugin","id","saveServiceName","_services","x","pushEmbedContent","options","pluginOptions","getTemplate","_embeds","content","$await_7","find","template","data","_process","$await_11","fetch","_omitScript","maxWidth","hideMedia","hideThread","align","lang","theme","linkColor","widgetType","params","url","omitScript","html","apiUrl","getQuery","isBrowser","jsonp","$await_2","json","twitter","opts","defaultOptions","twttr","window","_onLoadInternal","onLoad","isDom","service","widgets","load","events","bind","renderTweet","val","Node","nodeType","nodeName","_typeof","Symbol","iterator","constructor","prototype","document","anchorRegex","inlineEmbed","_ignoreAnchorCheck","_ignoreInlineCheck","replaceUrl","_replaceAnyways","string","getMatch","t","$await_14","anchorReplace","$await_12","basicReplace","output","$await_17","$await_9","saveEmbedData","esc","encodeURIComponent","Object","keys","k","join","transform","insert","$await_1","factory","exports","module","this","clearFunction","functionName","undefined","removeScript","scriptId","script","getElementById","getElementsByTagName","removeChild","timeout","jsonpCallback","jsonpCallbackFunction","_url","timeoutId","callbackFunction","Date","now","Math","ceil","random","response","ok","clearTimeout","indexOf","jsonpScript","createElement","setAttribute","charset","appendChild","setTimeout","onerror"],"mappings":"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"}