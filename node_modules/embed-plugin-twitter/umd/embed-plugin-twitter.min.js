!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.embedPluginTwitter=n()}(this,function(){"use strict";function e(){var n=[].slice.call(arguments),t=!1;"boolean"==typeof n[0]&&(t=n.shift());var r=n[0];if(!r||"object"!=typeof r&&"function"!=typeof r)throw new Error("extendee must be an object");for(var o=n.slice(1),i=o.length,u=0;u<i;u++){var c=o[u];for(var a in c)if(c.hasOwnProperty(a)){var f=c[a];if(t&&function(e){return Array.isArray(e)||"[object Object]"=={}.toString.call(e)}(f)){var l=Array.isArray(f)?[]:{};r[a]=e(!0,r.hasOwnProperty(a)?r[a]:l,f)}else r[a]=f}}return r}function n(e,n){var t=e.map(function(e){return function(e,n){var t=e.concat([e.index,e.input]);return n.apply(null,t).then(function(n){return l({},e,{replacement:n})})}(e,n)});return Promise.all(t)}function t(e,t,r){t.lastIndex=0;try{return Promise.resolve(function(e,t,r){return n(function(e,n){for(var t=[],r=n.exec(e);r&&(t.push(r),n.global);)r=n.exec(e);return t}(e,t),r).then(function(n){return function(e,t){return n.reverse().reduce(function(e,n){var t=e.slice(0,n.index),r=e.slice(n.index+n[0].length);return t+n.replacement+r},e)}(e)})}(e,t,r))}catch(e){return Promise.reject(e)}}function r(e,n,t){return void 0===t&&(t=!1),t?e.test(n):n.match(e)}function o(e,n){var t=e.result,r=e.plugins;void 0===r&&(r=[]);return function(e){return new RegExp("<a[^>]*>("+e.source+")<\\/a>","gi")}(n.regex).test(t)||r.filter(function(e){return"url"===e.id}).length}function i(e,n,t){var r=e._services,o=n.id;r.filter(function(e){return e.match===t}).length||r.push({id:o,match:t})}function u(e,n,r,o){return new Promise(function(u,a){var f,l;return l=r,f=l.regex,t(e,f,function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new Promise(function(t,u){return c(e,n,r).then(function(c){try{return n._embeds.push({content:c,index:o||e.find(function(e){return"number"==typeof e})}),i(n,r,e[0]),t()}catch(e){return u(e)}},u)})}).then(function(e){try{return u(n)}catch(e){return a(e)}},a)})}function c(e,n,t){var r=this;return new Promise(function(o,i){function u(){return o(a(e,n,t,f))}var c,a,f,l;return l=t,c=l._process,a=l.template,c?c(e,n,t).then(function(e){try{return f=e,u.call(r)}catch(e){return i(e)}},i):u.call(r)})}function a(e,n,t){var r=n.fetch,o=t._omitScript,i=t.maxWidth,u=t.hideMedia,c=t.hideThread,a=t.align,f=t.lang,l=t.theme,d=t.linkColor,s=t.widgetType;return new Promise(function(n,t){var m,p,y;m={url:e[0],omitScript:o,maxWidth:i,hideMedia:u,hideThread:c,align:a,lang:f,theme:l,linkColor:d,widgetType:s};var g=function(e){try{return n({html:""})}catch(e){return t(e)}};try{return p="https://api.twitter.com/1/statuses/oembed.json?"+w(m),(h?v:r)(p).then(function(e){try{return(y=e).json().then(n,g)}catch(e){return g()}},g)}catch(e){g()}})}function f(e){var n={id:g,regex:/https:\/\/twitter\.com\/\w+\/\w+\/\d+/gi,maxWidth:550,hideMedia:!1,hideThread:!1,align:"none",lang:"en",theme:"light",linkColor:"#355acee",widgetType:"",template:function(e,n,t,r){return r.html},_omitScript:!0,twttr:h?window.twttr:null,_onLoadInternal:function(e,n){!function(e,n){var t=e.input,r=e._services,o=n.twttr,i=n.onLoad;if(!d(t))throw new Error("input should be a DOM element to embed tweet.");r.filter(function(e){return"twitter"===e.id}).length&&(o.widgets.load(t),o.events.bind("loaded",i))}(e,n)},onLoad:function(){}},t=l({},n,e,{_process:a});return y(t)}var l=e,d=function(e){return!(!e||"object"!=typeof e)&&("object"==typeof window&&"object"==typeof window.Node?e instanceof window.Node:"number"==typeof e.nodeType&&"string"==typeof e.nodeName)},s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h="object"===("undefined"==typeof window?"undefined":s(window))&&"object"===("undefined"==typeof document?"undefined":s(document))&&9===document.nodeType,m=/<a[^>]*>([^<]+)<\/a>/gi,p=function(e,n){return new Promise(function(a,f){var d,s,h,p,w;d=e.inlineEmbed;var y;return y=n,s=y._ignoreAnchorCheck,h=y._ignoreInlineCheck,p=y.regex,d||h?new Promise(function(u,a){return o(e,{regex:p})&&!s?function(e,n){return new Promise(function(o,u){var a=e.result,f=e.replaceUrl,l=n.regex,d=n._replaceAnyways;return o(t(a,m,function(o,u){return new Promise(function(a,s){var h,m;return r(l,u,!0)?f||d?a(t(u,l,function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return new Promise(function(r,o){return i(e,n,t[0]),r(c(t,e,n))})})):(h=function(e,n){e.lastIndex=0;var t=e.exec(n);return e.lastIndex=0,t}(l,u),i(e,n,h[0]),c(h,e,n).then(function(e){try{return m=e,a(h?o+m:o)}catch(e){return s(e)}},s)):a(o)})}))})}(e,n).then(u,a):function(e,n){return new Promise(function(r,o){var u=e.result,a=e.replaceUrl,f=n.regex,l=n._replaceAnyways;return r(t(u,f,function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return new Promise(function(r,o){return i(e,n,t[0]),new Promise(function(r,o){return a||l?r(c(t,e,n)):c(t,e,n).then(function(e){try{return r(t[0]+" "+e)}catch(e){return o(e)}},o)}).then(r,o)})}))})}(e,n).then(u,a)}).then(function(n){try{return w=n,a(l({},e,{result:w}))}catch(e){return f(e)}},f):a(function(e,n){var c=this;return new Promise(function(a,f){function d(){return a(h)}var s,h,p;return p=n,s=p.regex,h=l({},e),o(h,{regex:s})?t(h.result,m,function(e,t,o){return new Promise(function(c,a){return r(s,e,!0)?(i(h,n,e),u(t,h,n,o).then(function(n){try{return h=n,c(e)}catch(e){return a(e)}},a)):c(e)})}).then(function(e){try{return d.call(c)}catch(e){return f(e)}},f):(h=u(h.result,h,n),d.call(c))})}(e,n))})},w=function(e){var n=encodeURIComponent;return Object.keys(e).map(function(t){return n(t)+"="+n(e[t])}).join("&")},y=function(e){var n=l({},{_replaceAnyways:!1,_ignoreAnchorCheck:!1,_ignoreInlineCheck:!1,onLoad:function(){}},e),t=n._onLoadInternal,r=n.onLoad,o=n.regex,i=n.template,u=n.id;if(!o)throw new Error("regex not passed.");if(!i)throw new Error("template not passed.");return{id:u,transform:function(e){return new Promise(function(t,r){return p(e,n).then(function(n){try{return t(l({},e,n))}catch(e){return r(e)}},r)})},onLoad:function(e){t&&t(e,n),r&&r(e,n)}}},v=("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self,function(e,n){return n={exports:{}},e(n,n.exports),n.exports}(function(e,n){!function(t,r){r(n,e)}(0,function(e,n){function t(e){try{delete window[e]}catch(n){window[e]=void 0}}function r(e){var n=document.getElementById(e);n&&document.getElementsByTagName("head")[0].removeChild(n)}var o={timeout:5e3,jsonpCallback:"callback",jsonpCallbackFunction:null};n.exports=function(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=e,u=n.timeout||o.timeout,c=n.jsonpCallback||o.jsonpCallback,a=void 0;return new Promise(function(o,f){var l=n.jsonpCallbackFunction||"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random()),d=c+"_"+l;window[l]=function(e){o({ok:!0,json:function(){return Promise.resolve(e)}}),a&&clearTimeout(a),r(d),t(l)},i+=-1===i.indexOf("?")?"?":"&";var s=document.createElement("script");s.setAttribute("src",""+i+c+"="+l),n.charset&&s.setAttribute("charset",n.charset),s.id=d,document.getElementsByTagName("head")[0].appendChild(s),a=setTimeout(function(){f(new Error("JSONP request to "+e+" timed out")),t(l),r(d),window[l]=function(){t(l)}},u),s.onerror=function(){f(new Error("JSONP request to "+e+" failed")),t(l),r(d),a&&clearTimeout(a)}})}})})),g="twitter";return f.id=g,f});
//# sourceMappingURL=embed-plugin-twitter.min.js.map
