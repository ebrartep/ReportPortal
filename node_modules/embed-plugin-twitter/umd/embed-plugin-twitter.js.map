{"version":3,"file":"embed-plugin-twitter.js","sources":["../../../node_modules/just-extend/index.js","../../../node_modules/is-dom/index.js","../../../node_modules/is-in-browser/dist/module.js","../../embed-plugin-utilities/src/string-replace-async.js","../../embed-plugin-utilities/src/insert.js","../../embed-plugin-utilities/src/get-query.js","../../embed-plugin-base/src/index.js","../../../node_modules/fetch-jsonp/build/fetch-jsonp.js","../src/index.js"],"sourcesContent":["module.exports = extend;\n\n/*\n  var obj = {a: 3, b: 5};\n  extend(obj, {a: 4, c: 8}); // {a: 4, b: 5, c: 8}\n  obj; // {a: 4, b: 5, c: 8}\n\n  var obj = {a: 3, b: 5};\n  extend({}, obj, {a: 4, c: 8}); // {a: 4, b: 5, c: 8}\n  obj; // {a: 3, b: 5}\n\n  var arr = [1, 2, 3];\n  var obj = {a: 3, b: 5};\n  extend(obj, {c: arr}); // {a: 3, b: 5, c: [1, 2, 3]}\n  arr.push(4);\n  obj; // {a: 3, b: 5, c: [1, 2, 3, 4]}\n\n  var arr = [1, 2, 3];\n  var obj = {a: 3, b: 5};\n  extend(true, obj, {c: arr}); // {a: 3, b: 5, c: [1, 2, 3]}\n  arr.push(4);\n  obj; // {a: 3, b: 5, c: [1, 2, 3]}\n\n  extend({a: 4, b: 5}); // {a: 4, b: 5}\n  extend({a: 4, b: 5}, 3); {a: 4, b: 5}\n  extend({a: 4, b: 5}, true); {a: 4, b: 5}\n  extend('hello', {a: 4, b: 5}); // throws\n  extend(3, {a: 4, b: 5}); // throws\n*/\n\nfunction extend(/* [deep], obj1, obj2, [objn] */) {\n  var args = [].slice.call(arguments);\n  var deep = false;\n  if (typeof args[0] == 'boolean') {\n    deep = args.shift();\n  }\n  var result = args[0];\n  if (!result || (typeof result != 'object' && typeof result != 'function')) {\n    throw new Error('extendee must be an object');\n  }\n  var extenders = args.slice(1);\n  var len = extenders.length;\n  for (var i = 0; i < len; i++) {\n    var extender = extenders[i];\n    for (var key in extender) {\n      if (extender.hasOwnProperty(key)) {\n        var value = extender[key];\n        if (deep && isCloneable(value)) {\n          var base = Array.isArray(value) ? [] : {};\n          result[key] = extend(true, result.hasOwnProperty(key) ? result[key] : base, value);\n        } else {\n          result[key] = value;\n        }\n      }\n    }\n  }\n  return result;\n}\n\nfunction isCloneable(obj) {\n  return Array.isArray(obj) || {}.toString.call(obj) == '[object Object]';\n}\n","module.exports = isNode\n\nfunction isNode (val) {\n  return (!val || typeof val !== 'object')\n    ? false\n    : (typeof window === 'object' && typeof window.Node === 'object')\n      ? (val instanceof window.Node)\n      : (typeof val.nodeType === 'number') &&\n        (typeof val.nodeName === 'string')\n}\n","var _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexport var isBrowser = (typeof window === \"undefined\" ? \"undefined\" : _typeof(window)) === \"object\" && (typeof document === \"undefined\" ? \"undefined\" : _typeof(document)) === 'object' && document.nodeType === 9;\n\nexport default isBrowser;\n","import extend from \"just-extend\"\n\nfunction matchAll(str, re) {\n  const matches = []\n  let res = re.exec(str)\n\n  while (res) {\n    matches.push(res)\n\n    if (!re.global) {\n      break\n    }\n\n    res = re.exec(str)\n  }\n  return matches\n}\n\nfunction replaceAll(str, matches) {\n  return matches.reverse().reduce(function(res, match) {\n    const prefix = res.slice(0, match.index)\n    const postfix = res.slice(match.index + match[0].length)\n\n    return prefix + match.replacement + postfix\n  }, str)\n}\n\nfunction assignReplacement(match, replacer) {\n  const args = match.concat([match.index, match.input])\n\n  return replacer.apply(null, args).then(function(res) {\n    return extend({}, match, { replacement: res })\n  })\n}\n\nfunction concurrency(matches, replacer) {\n  const promises = matches.map(function(match) {\n    return assignReplacement(match, replacer)\n  })\n\n  return Promise.all(promises)\n}\n\nfunction processString(str, re, replacer) {\n  const matches = matchAll(str, re)\n  const processor = concurrency\n\n  return processor(matches, replacer).then(function(matches) {\n    return replaceAll(str, matches)\n  })\n}\n\nfunction stringReplaceAsync(str, re, replacer) {\n  re.lastIndex = 0\n  try {\n    return Promise.resolve(processString(str, re, replacer))\n  } catch (e) {\n    return Promise.reject(e)\n  }\n}\n\nexport default stringReplaceAsync\n","import extend from \"just-extend\"\nimport stringReplaceAsync from \"./string-replace-async\"\n\nconst anchorRegex = /<a[^>]*>([^<]+)<\\/a>/gi\n\nfunction getAnchorRegex(regex) {\n  return new RegExp(`<a[^>]*>(${regex.source})<\\\\/a>`, \"gi\")\n}\n\n/**\n * Returns the matched regex data or whether the text has any matching string\n * @param regex Regex of the matching pattern\n * @param text String which has to be searched\n * @param test Return boolean or matching array\n * @returns {*} Boolean|Array\n */\nfunction isMatchPresent(regex, text, test = false) {\n  return test ? regex.test(text) : text.match(regex)\n}\n\n/**\n * Tells wheteher the matching string is present inside an anchor tag\n * @param text\n * @returns {*} Boolean\n * @param regex\n */\nfunction isAnchorTagApplied({ result, plugins = [] }, { regex }) {\n  return (\n    getAnchorRegex(regex).test(result) ||\n    plugins.filter(plugin => plugin.id === \"url\").length\n  )\n}\n\nfunction saveServiceName({ _services }, { id }, match) {\n  if (!_services.filter(x => x.match === match).length) {\n    _services.push({ id, match })\n  }\n}\n\nasync function pushEmbedContent(text, options, pluginOptions, index) {\n  const { regex } = pluginOptions\n  await stringReplaceAsync(text, regex, async (...args) => {\n    options._embeds.push({\n      content: await getTemplate(args, options, pluginOptions),\n      index: index || args.find(x => typeof x === \"number\")\n    })\n    saveServiceName(options, pluginOptions, args[0])\n  })\n  return options\n}\n\n/**\n * Save the embed code into an array that can be added later to the end of original string\n * @param opts\n * @param pluginOptions\n */\nasync function saveEmbedData(opts, pluginOptions) {\n  const { regex } = pluginOptions\n  let options = extend({}, opts)\n\n  if (isAnchorTagApplied(options, { regex })) {\n    await stringReplaceAsync(\n      options.result,\n      anchorRegex,\n      async (match, url, index) => {\n        if (!isMatchPresent(regex, match, true)) return match\n        saveServiceName(options, pluginOptions, match)\n        options = await pushEmbedContent(url, options, pluginOptions, index)\n        return match\n      }\n    )\n  } else {\n    options = pushEmbedContent(options.result, options, pluginOptions)\n  }\n\n  return options\n}\n\nfunction getMatch(regex, string) {\n  regex.lastIndex = 0\n  const matches = regex.exec(string)\n  regex.lastIndex = 0\n  return matches\n}\n\nasync function getTemplate(args, options, pluginOptions) {\n  const { _process, template } = pluginOptions\n  let data\n  if (_process) {\n    data = await _process(args, options, pluginOptions)\n  }\n  return template(args, options, pluginOptions, data)\n}\n\nasync function basicReplace(options, pluginOptions) {\n  const { result, replaceUrl } = options\n  const { regex, _replaceAnyways } = pluginOptions\n  return stringReplaceAsync(result, regex, async (...args) => {\n    saveServiceName(options, pluginOptions, args[0])\n    return replaceUrl || _replaceAnyways\n      ? getTemplate(args, options, pluginOptions)\n      : `${args[0]} ${await getTemplate(args, options, pluginOptions)}`\n  })\n}\n\nasync function anchorReplace(options, pluginOptions) {\n  const { result, replaceUrl } = options\n  const { regex, _replaceAnyways } = pluginOptions\n\n  return stringReplaceAsync(result, anchorRegex, async (match, url) => {\n    if (!isMatchPresent(regex, url, true)) {\n      return match\n    }\n\n    if (!(replaceUrl || _replaceAnyways)) {\n      const args = getMatch(regex, url)\n      saveServiceName(options, pluginOptions, args[0])\n      const t = await getTemplate(args, options, pluginOptions)\n      return args ? match + t : match\n    }\n    return stringReplaceAsync(url, regex, async (...args) => {\n      saveServiceName(options, pluginOptions, args[0])\n      return getTemplate(args, options, pluginOptions)\n    })\n  })\n}\n\n/**\n * Insert the embed code in the original string.\n * @param options\n * @param pluginOptions\n * @returns options\n */\nexport default async function(options, pluginOptions) {\n  const { inlineEmbed } = options\n  const { _ignoreAnchorCheck, _ignoreInlineCheck, regex } = pluginOptions\n\n  if (!inlineEmbed && !_ignoreInlineCheck) {\n    return saveEmbedData(options, pluginOptions)\n  }\n\n  let output\n\n  output =\n    isAnchorTagApplied(options, { regex }) && !_ignoreAnchorCheck\n      ? await anchorReplace(options, pluginOptions)\n      : await basicReplace(options, pluginOptions)\n\n  return extend({}, options, {\n    result: output\n  })\n}\n","export default function(params) {\n  const esc = encodeURIComponent\n  return Object.keys(params).map(k => `${esc(k)}=${esc(params[k])}`).join(\"&\")\n}\n","import extend from \"just-extend\"\nimport { insert } from \"embed-plugin-utilities\"\n\nexport default opts => {\n  const defaultOptions = {\n    _replaceAnyways: false,\n    _ignoreAnchorCheck: false,\n    _ignoreInlineCheck: false,\n    onLoad() {}\n  }\n\n  const pluginOptions = extend({}, defaultOptions, opts)\n\n  const { _onLoadInternal, onLoad, regex, template, id } = pluginOptions\n\n  if (!regex) {\n    throw new Error(\"regex not passed.\")\n  }\n  if (!template) {\n    throw new Error(\"template not passed.\")\n  }\n\n  return {\n    id,\n\n    async transform(options) {\n      return extend({}, options, await insert(options, pluginOptions))\n    },\n\n    onLoad(options) {\n      if (_onLoadInternal) {\n        _onLoadInternal(options, pluginOptions)\n      }\n      if (onLoad) {\n        onLoad(options, pluginOptions)\n      }\n    }\n  }\n}\n","(function (global, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define(['exports', 'module'], factory);\n  } else if (typeof exports !== 'undefined' && typeof module !== 'undefined') {\n    factory(exports, module);\n  } else {\n    var mod = {\n      exports: {}\n    };\n    factory(mod.exports, mod);\n    global.fetchJsonp = mod.exports;\n  }\n})(this, function (exports, module) {\n  'use strict';\n\n  var defaultOptions = {\n    timeout: 5000,\n    jsonpCallback: 'callback',\n    jsonpCallbackFunction: null\n  };\n\n  function generateCallbackFunction() {\n    return 'jsonp_' + Date.now() + '_' + Math.ceil(Math.random() * 100000);\n  }\n\n  function clearFunction(functionName) {\n    // IE8 throws an exception when you try to delete a property on window\n    // http://stackoverflow.com/a/1824228/751089\n    try {\n      delete window[functionName];\n    } catch (e) {\n      window[functionName] = undefined;\n    }\n  }\n\n  function removeScript(scriptId) {\n    var script = document.getElementById(scriptId);\n    if (script) {\n      document.getElementsByTagName('head')[0].removeChild(script);\n    }\n  }\n\n  function fetchJsonp(_url) {\n    var options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n    // to avoid param reassign\n    var url = _url;\n    var timeout = options.timeout || defaultOptions.timeout;\n    var jsonpCallback = options.jsonpCallback || defaultOptions.jsonpCallback;\n\n    var timeoutId = undefined;\n\n    return new Promise(function (resolve, reject) {\n      var callbackFunction = options.jsonpCallbackFunction || generateCallbackFunction();\n      var scriptId = jsonpCallback + '_' + callbackFunction;\n\n      window[callbackFunction] = function (response) {\n        resolve({\n          ok: true,\n          // keep consistent with fetch API\n          json: function json() {\n            return Promise.resolve(response);\n          }\n        });\n\n        if (timeoutId) clearTimeout(timeoutId);\n\n        removeScript(scriptId);\n\n        clearFunction(callbackFunction);\n      };\n\n      // Check if the user set their own params, and if not add a ? to start a list of params\n      url += url.indexOf('?') === -1 ? '?' : '&';\n\n      var jsonpScript = document.createElement('script');\n      jsonpScript.setAttribute('src', '' + url + jsonpCallback + '=' + callbackFunction);\n      if (options.charset) {\n        jsonpScript.setAttribute('charset', options.charset);\n      }\n      jsonpScript.id = scriptId;\n      document.getElementsByTagName('head')[0].appendChild(jsonpScript);\n\n      timeoutId = setTimeout(function () {\n        reject(new Error('JSONP request to ' + _url + ' timed out'));\n\n        clearFunction(callbackFunction);\n        removeScript(scriptId);\n        window[callbackFunction] = function () {\n          clearFunction(callbackFunction);\n        };\n      }, timeout);\n\n      // Caught if got 404/500\n      jsonpScript.onerror = function () {\n        reject(new Error('JSONP request to ' + _url + ' failed'));\n\n        clearFunction(callbackFunction);\n        removeScript(scriptId);\n        if (timeoutId) clearTimeout(timeoutId);\n      };\n    });\n  }\n\n  // export as global function\n  /*\n  let local;\n  if (typeof global !== 'undefined') {\n    local = global;\n  } else if (typeof self !== 'undefined') {\n    local = self;\n  } else {\n    try {\n      local = Function('return this')();\n    } catch (e) {\n      throw new Error('polyfill failed because global object is unavailable in this environment');\n    }\n  }\n  local.fetchJsonp = fetchJsonp;\n  */\n\n  module.exports = fetchJsonp;\n});","import extend from \"just-extend\"\nimport isDom from \"is-dom\"\nimport isBrowser from \"is-in-browser\"\nimport base from \"embed-plugin-base\"\nimport { getQuery } from \"embed-plugin-utilities\"\nimport jsonp from \"fetch-jsonp\"\n\nconst id = \"twitter\"\n\n/**\n * Fetch the html content from the API\n * @param url\n * @param args\n * @param omitScript\n * @param maxWidth\n * @param hideMedia\n * @param hideThread\n * @param align\n * @param lang\n * @param theme\n * @param linkColor\n * @param widgetType\n * @returns {Promise.<*>}\n */\nasync function _process(\n  args,\n  { fetch },\n  {\n    _omitScript,\n    maxWidth,\n    hideMedia,\n    hideThread,\n    align,\n    lang,\n    theme,\n    linkColor,\n    widgetType\n  }\n) {\n  const params = {\n    url: args[0],\n    omitScript: _omitScript,\n    maxWidth,\n    hideMedia,\n    hideThread,\n    align,\n    lang,\n    theme,\n    linkColor,\n    widgetType\n  }\n  try {\n    const apiUrl = `https://api.twitter.com/1/statuses/oembed.json?${getQuery(\n      params\n    )}`\n    const res = await (isBrowser ? jsonp : fetch)(apiUrl)\n    return await res.json()\n  } catch (e) {\n    return {\n      html: \"\"\n    }\n  }\n}\n\nfunction renderTweet({ input, _services }, { twttr, onLoad }) {\n  if (!isDom(input)) {\n    throw new Error(\"input should be a DOM element to embed tweet.\")\n  }\n  if (_services.filter(service => service.id === \"twitter\").length) {\n    twttr.widgets.load(input)\n    twttr.events.bind(\"loaded\", onLoad)\n  }\n}\n\nexport default function twitter(opts) {\n  const defaultOptions = {\n    id,\n    // Regex that matches the string and sends to the template method.\n    regex: /https:\\/\\/twitter\\.com\\/\\w+\\/\\w+\\/\\d+/gi,\n\n    // The maximum width of a rendered Tweet in whole pixels.\n    // This value must be between 220 and 550 inclusive. A supplied\n    // value under or over the allowed range will be returned as the\n    // minimum or maximum supported width respectively; the reset width\n    // value will be reflected in the returned width property. Note that\n    // Twitter does not support the oEmbed maxheight parameter. Tweets\n    // are fundamentally text, and are therefore of unpredictable height\n    // that cannot be scaled like an image or video. Relatedly, the\n    // oEmbed response will not provide a value for height. Implementations\n    // that need consistent heights for Tweets should refer to the hide_thread\n    // and hide_media parameters below.\n    maxWidth: 550,\n\n    // When set to true , t, or 1 links in a Tweet are not expanded to photo,\n    // video, or link previews\n    hideMedia: false,\n\n    // When set to true , t, or 1 a collapsed version of the previous Tweet\n    // in a conversation thread will not be displayed when the requested Tweet\n    // is in reply to another Tweet\n    hideThread: false,\n\n    // Specifies whether the embedded Tweet should be floated left,\n    // right, or center in the page relative to the parent element.\n    // Valid values are left, right, center, and none\n    align: \"none\",\n\n    // Request returned HTML and a rendered Tweet in the specified Twitter\n    // language supported by embedded Tweets. https://dev.twitter.com/web/overview/languages\n    lang: \"en\",\n\n    // When set to dark, the Tweet is displayed with light text over a dark background\n    theme: \"light\",\n\n    // Adjust the color of Tweet text links with a hexadecimal color value\n    linkColor: \"#355acee\",\n\n    // Set to video to return a Twitter Video embed for the given Tweet\n    widgetType: \"\",\n\n    /**\n\t\t * It accepts the matching url and returns the html\n\t\t * content that replaces or appends to the URL based\n\t\t * on options. This can return a asynchronous response.\n\t\t * @param args\n\t\t * @param options\n\t\t * @param pluginOptions\n\t\t * @param html\n\t\t * @returns {Promise.<*>}\n\t\t */\n    template(args, options, pluginOptions, { html }) {\n      return html\n    },\n\n    // If you want to load the twitter widget script with the tweet itself\n    // turn this option to false. Else you have to load it externally.\n    _omitScript: true,\n\n    // The twitter object loaded from widgets.js. By default it takes twttr\n    // from window object.\n    twttr: isBrowser ? window.twttr : null,\n\n    // This is for internal use only. Executes when\n    // the tweet has been loaded\n    // and rendered on the client side\n    _onLoadInternal(options, pluginOptions) {\n      renderTweet(options, pluginOptions)\n    },\n\n    // executed when the tweet has been loaded\n    // and rendered on the client side\n    onLoad() {}\n  }\n\n  const pluginOptions = extend({}, defaultOptions, opts, {\n    _process\n  })\n  return base(pluginOptions)\n}\n\ntwitter.id = id\n"],"names":["const","let","extend","define","this","jsonp"],"mappings":"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"}