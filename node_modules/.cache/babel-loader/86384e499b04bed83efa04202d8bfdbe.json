{"remainingRequest":"C:\\vue\\supplier-portal\\node_modules\\thread-loader\\dist\\cjs.js!C:\\vue\\supplier-portal\\node_modules\\babel-loader\\lib\\index.js!C:\\vue\\supplier-portal\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\vue\\supplier-portal\\src\\@core\\auth\\jwt\\jwtService.js","dependencies":[{"path":"C:\\vue\\supplier-portal\\src\\@core\\auth\\jwt\\jwtService.js","mtime":1616409454682},{"path":"C:\\vue\\supplier-portal\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\vue\\supplier-portal\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\vue\\supplier-portal\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\vue\\supplier-portal\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiQzovdnVlL3N1cHBsaWVyLXBvcnRhbC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMiI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiQzovdnVlL3N1cHBsaWVyLXBvcnRhbC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIkM6L3Z1ZS9zdXBwbGllci1wb3J0YWwvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICJDOi92dWUvc3VwcGxpZXItcG9ydGFsL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9kZWZpbmVQcm9wZXJ0eSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgand0RGVmYXVsdENvbmZpZyBmcm9tICcuL2p3dERlZmF1bHRDb25maWcnOwoKdmFyIEp3dFNlcnZpY2UgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIC8vIFdpbGwgYmUgdXNlZCBieSB0aGlzIHNlcnZpY2UgZm9yIG1ha2luZyBBUEkgY2FsbHMKICAvLyBqd3RDb25maWcgPD0gV2lsbCBiZSB1c2VkIGJ5IHRoaXMgc2VydmljZQogIC8vIEZvciBSZWZyZXNoaW5nIFRva2VuCiAgLy8gRm9yIFJlZnJlc2hpbmcgVG9rZW4KICBmdW5jdGlvbiBKd3RTZXJ2aWNlKGF4aW9zSW5zLCBqd3RPdmVycmlkZUNvbmZpZykgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSnd0U2VydmljZSk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJheGlvc0lucyIsIG51bGwpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiand0Q29uZmlnIiwgX29iamVjdFNwcmVhZCh7fSwgand0RGVmYXVsdENvbmZpZykpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiaXNBbHJlYWR5RmV0Y2hpbmdBY2Nlc3NUb2tlbiIsIGZhbHNlKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgInN1YnNjcmliZXJzIiwgW10pOwoKICAgIHRoaXMuYXhpb3NJbnMgPSBheGlvc0luczsKICAgIHRoaXMuand0Q29uZmlnID0gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCB0aGlzLmp3dENvbmZpZyksIGp3dE92ZXJyaWRlQ29uZmlnKTsgLy8gUmVxdWVzdCBJbnRlcmNlcHRvcgoKICAgIHRoaXMuYXhpb3NJbnMuaW50ZXJjZXB0b3JzLnJlcXVlc3QudXNlKGZ1bmN0aW9uIChjb25maWcpIHsKICAgICAgLy8gR2V0IHRva2VuIGZyb20gbG9jYWxTdG9yYWdlCiAgICAgIHZhciBhY2Nlc3NUb2tlbiA9IF90aGlzLmdldFRva2VuKCk7IC8vIElmIHRva2VuIGlzIHByZXNlbnQgYWRkIGl0IHRvIHJlcXVlc3QncyBBdXRob3JpemF0aW9uIEhlYWRlcgoKCiAgICAgIGlmIChhY2Nlc3NUb2tlbikgewogICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wYXJhbS1yZWFzc2lnbgogICAgICAgIGNvbmZpZy5oZWFkZXJzLkF1dGhvcml6YXRpb24gPSAiIi5jb25jYXQoX3RoaXMuand0Q29uZmlnLnRva2VuVHlwZSwgIiAiKS5jb25jYXQoYWNjZXNzVG9rZW4pOwogICAgICB9CgogICAgICByZXR1cm4gY29uZmlnOwogICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7CiAgICB9KTsgLy8gQWRkIHJlcXVlc3QvcmVzcG9uc2UgaW50ZXJjZXB0b3IKCiAgICB0aGlzLmF4aW9zSW5zLmludGVyY2VwdG9ycy5yZXNwb25zZS51c2UoZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgIHJldHVybiByZXNwb25zZTsKICAgIH0sIGZ1bmN0aW9uIChlcnJvcikgewogICAgICAvLyBjb25zdCB7IGNvbmZpZywgcmVzcG9uc2U6IHsgc3RhdHVzIH0gfSA9IGVycm9yCiAgICAgIHZhciBjb25maWcgPSBlcnJvci5jb25maWcsCiAgICAgICAgICByZXNwb25zZSA9IGVycm9yLnJlc3BvbnNlOwogICAgICB2YXIgb3JpZ2luYWxSZXF1ZXN0ID0gY29uZmlnOyAvLyBpZiAoc3RhdHVzID09PSA0MDEpIHsKCiAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5zdGF0dXMgPT09IDQwMSkgewogICAgICAgIGlmICghX3RoaXMuaXNBbHJlYWR5RmV0Y2hpbmdBY2Nlc3NUb2tlbikgewogICAgICAgICAgX3RoaXMuaXNBbHJlYWR5RmV0Y2hpbmdBY2Nlc3NUb2tlbiA9IHRydWU7CgogICAgICAgICAgX3RoaXMucmVmcmVzaFRva2VuKCkudGhlbihmdW5jdGlvbiAocikgewogICAgICAgICAgICBfdGhpcy5pc0FscmVhZHlGZXRjaGluZ0FjY2Vzc1Rva2VuID0gZmFsc2U7IC8vIFVwZGF0ZSBhY2Nlc3NUb2tlbiBpbiBsb2NhbFN0b3JhZ2UKCiAgICAgICAgICAgIF90aGlzLnNldFRva2VuKHIuZGF0YS5hY2Nlc3NUb2tlbik7CgogICAgICAgICAgICBfdGhpcy5zZXRSZWZyZXNoVG9rZW4oci5kYXRhLnJlZnJlc2hUb2tlbik7CgogICAgICAgICAgICBfdGhpcy5vbkFjY2Vzc1Rva2VuRmV0Y2hlZChyLmRhdGEuYWNjZXNzVG9rZW4pOwogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICB2YXIgcmV0cnlPcmlnaW5hbFJlcXVlc3QgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgICAgX3RoaXMuYWRkU3Vic2NyaWJlcihmdW5jdGlvbiAoYWNjZXNzVG9rZW4pIHsKICAgICAgICAgICAgLy8gTWFrZSBzdXJlIHRvIGFzc2lnbiBhY2Nlc3NUb2tlbiBhY2NvcmRpbmcgdG8geW91ciByZXNwb25zZS4KICAgICAgICAgICAgLy8gQ2hlY2s6IGh0dHBzOi8vcGl4aW52ZW50LnRpY2tzeS5jb20vdGlja2V0LzI0MTM4NzAKICAgICAgICAgICAgLy8gQ2hhbmdlIEF1dGhvcml6YXRpb24gaGVhZGVyCiAgICAgICAgICAgIG9yaWdpbmFsUmVxdWVzdC5oZWFkZXJzLkF1dGhvcml6YXRpb24gPSAiIi5jb25jYXQoX3RoaXMuand0Q29uZmlnLnRva2VuVHlwZSwgIiAiKS5jb25jYXQoYWNjZXNzVG9rZW4pOwogICAgICAgICAgICByZXNvbHZlKF90aGlzLmF4aW9zSW5zKG9yaWdpbmFsUmVxdWVzdCkpOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHJldHJ5T3JpZ2luYWxSZXF1ZXN0OwogICAgICB9CgogICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpOwogICAgfSk7CiAgfQoKICBfY3JlYXRlQ2xhc3MoSnd0U2VydmljZSwgW3sKICAgIGtleTogIm9uQWNjZXNzVG9rZW5GZXRjaGVkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvbkFjY2Vzc1Rva2VuRmV0Y2hlZChhY2Nlc3NUb2tlbikgewogICAgICB0aGlzLnN1YnNjcmliZXJzID0gdGhpcy5zdWJzY3JpYmVycy5maWx0ZXIoZnVuY3Rpb24gKGNhbGxiYWNrKSB7CiAgICAgICAgcmV0dXJuIGNhbGxiYWNrKGFjY2Vzc1Rva2VuKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiYWRkU3Vic2NyaWJlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYWRkU3Vic2NyaWJlcihjYWxsYmFjaykgewogICAgICB0aGlzLnN1YnNjcmliZXJzLnB1c2goY2FsbGJhY2spOwogICAgfQogIH0sIHsKICAgIGtleTogImdldFRva2VuIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRUb2tlbigpIHsKICAgICAgcmV0dXJuIGxvY2FsU3RvcmFnZS5nZXRJdGVtKHRoaXMuand0Q29uZmlnLnN0b3JhZ2VUb2tlbktleU5hbWUpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldFJlZnJlc2hUb2tlbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UmVmcmVzaFRva2VuKCkgewogICAgICByZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0odGhpcy5qd3RDb25maWcuc3RvcmFnZVJlZnJlc2hUb2tlbktleU5hbWUpOwogICAgfQogIH0sIHsKICAgIGtleTogInNldFRva2VuIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRUb2tlbih2YWx1ZSkgewogICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSh0aGlzLmp3dENvbmZpZy5zdG9yYWdlVG9rZW5LZXlOYW1lLCB2YWx1ZSk7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0UmVmcmVzaFRva2VuIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRSZWZyZXNoVG9rZW4odmFsdWUpIHsKICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0odGhpcy5qd3RDb25maWcuc3RvcmFnZVJlZnJlc2hUb2tlbktleU5hbWUsIHZhbHVlKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJsb2dpbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbG9naW4oKSB7CiAgICAgIHZhciBfdGhpcyRheGlvc0luczsKCiAgICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykgewogICAgICAgIGFyZ3NbX2tleV0gPSBhcmd1bWVudHNbX2tleV07CiAgICAgIH0KCiAgICAgIHJldHVybiAoX3RoaXMkYXhpb3NJbnMgPSB0aGlzLmF4aW9zSW5zKS5wb3N0LmFwcGx5KF90aGlzJGF4aW9zSW5zLCBbdGhpcy5qd3RDb25maWcubG9naW5FbmRwb2ludF0uY29uY2F0KGFyZ3MpKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZWdpc3RlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVnaXN0ZXIoKSB7CiAgICAgIHZhciBfdGhpcyRheGlvc0luczI7CgogICAgICBmb3IgKHZhciBfbGVuMiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbjIpLCBfa2V5MiA9IDA7IF9rZXkyIDwgX2xlbjI7IF9rZXkyKyspIHsKICAgICAgICBhcmdzW19rZXkyXSA9IGFyZ3VtZW50c1tfa2V5Ml07CiAgICAgIH0KCiAgICAgIHJldHVybiAoX3RoaXMkYXhpb3NJbnMyID0gdGhpcy5heGlvc0lucykucG9zdC5hcHBseShfdGhpcyRheGlvc0luczIsIFt0aGlzLmp3dENvbmZpZy5yZWdpc3RlckVuZHBvaW50XS5jb25jYXQoYXJncykpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlZnJlc2hUb2tlbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVmcmVzaFRva2VuKCkgewogICAgICByZXR1cm4gdGhpcy5heGlvc0lucy5wb3N0KHRoaXMuand0Q29uZmlnLnJlZnJlc2hFbmRwb2ludCwgewogICAgICAgIHJlZnJlc2hUb2tlbjogdGhpcy5nZXRSZWZyZXNoVG9rZW4oKQogICAgICB9KTsKICAgIH0KICB9XSk7CgogIHJldHVybiBKd3RTZXJ2aWNlOwp9KCk7CgpleHBvcnQgeyBKd3RTZXJ2aWNlIGFzIGRlZmF1bHQgfTs="},{"version":3,"sources":["C:/vue/supplier-portal/src/@core/auth/jwt/jwtService.js"],"names":["jwtDefaultConfig","JwtService","axiosIns","jwtOverrideConfig","jwtConfig","interceptors","request","use","config","accessToken","getToken","headers","Authorization","tokenType","error","Promise","reject","response","originalRequest","status","isAlreadyFetchingAccessToken","refreshToken","then","r","setToken","data","setRefreshToken","onAccessTokenFetched","retryOriginalRequest","resolve","addSubscriber","subscribers","filter","callback","push","localStorage","getItem","storageTokenKeyName","storageRefreshTokenKeyName","value","setItem","args","post","loginEndpoint","registerEndpoint","refreshEndpoint","getRefreshToken"],"mappings":"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","sourcesContent":["import jwtDefaultConfig from './jwtDefaultConfig'\n\nexport default class JwtService {\n  // Will be used by this service for making API calls\n  axiosIns = null\n\n  // jwtConfig <= Will be used by this service\n  jwtConfig = { ...jwtDefaultConfig }\n\n  // For Refreshing Token\n  isAlreadyFetchingAccessToken = false\n\n  // For Refreshing Token\n  subscribers = []\n\n  constructor(axiosIns, jwtOverrideConfig) {\n    this.axiosIns = axiosIns\n    this.jwtConfig = { ...this.jwtConfig, ...jwtOverrideConfig }\n\n    // Request Interceptor\n    this.axiosIns.interceptors.request.use(\n      config => {\n        // Get token from localStorage\n        const accessToken = this.getToken()\n\n        // If token is present add it to request's Authorization Header\n        if (accessToken) {\n          // eslint-disable-next-line no-param-reassign\n          config.headers.Authorization = `${this.jwtConfig.tokenType} ${accessToken}`\n        }\n        return config\n      },\n      error => Promise.reject(error),\n    )\n\n    // Add request/response interceptor\n    this.axiosIns.interceptors.response.use(\n      response => response,\n      error => {\n        // const { config, response: { status } } = error\n        const { config, response } = error\n        const originalRequest = config\n\n        // if (status === 401) {\n        if (response && response.status === 401) {\n          if (!this.isAlreadyFetchingAccessToken) {\n            this.isAlreadyFetchingAccessToken = true\n            this.refreshToken().then(r => {\n              this.isAlreadyFetchingAccessToken = false\n\n              // Update accessToken in localStorage\n              this.setToken(r.data.accessToken)\n              this.setRefreshToken(r.data.refreshToken)\n\n              this.onAccessTokenFetched(r.data.accessToken)\n            })\n          }\n          const retryOriginalRequest = new Promise(resolve => {\n            this.addSubscriber(accessToken => {\n              // Make sure to assign accessToken according to your response.\n              // Check: https://pixinvent.ticksy.com/ticket/2413870\n              // Change Authorization header\n              originalRequest.headers.Authorization = `${this.jwtConfig.tokenType} ${accessToken}`\n              resolve(this.axiosIns(originalRequest))\n            })\n          })\n          return retryOriginalRequest\n        }\n        return Promise.reject(error)\n      },\n    )\n  }\n\n  onAccessTokenFetched(accessToken) {\n    this.subscribers = this.subscribers.filter(callback => callback(accessToken))\n  }\n\n  addSubscriber(callback) {\n    this.subscribers.push(callback)\n  }\n\n  getToken() {\n    return localStorage.getItem(this.jwtConfig.storageTokenKeyName)\n  }\n\n  getRefreshToken() {\n    return localStorage.getItem(this.jwtConfig.storageRefreshTokenKeyName)\n  }\n\n  setToken(value) {\n    localStorage.setItem(this.jwtConfig.storageTokenKeyName, value)\n  }\n\n  setRefreshToken(value) {\n    localStorage.setItem(this.jwtConfig.storageRefreshTokenKeyName, value)\n  }\n\n  login(...args) {\n    return this.axiosIns.post(this.jwtConfig.loginEndpoint, ...args)\n  }\n\n  register(...args) {\n    return this.axiosIns.post(this.jwtConfig.registerEndpoint, ...args)\n  }\n\n  refreshToken() {\n    return this.axiosIns.post(this.jwtConfig.refreshEndpoint, {\n      refreshToken: this.getRefreshToken(),\n    })\n  }\n}\n"]}]}